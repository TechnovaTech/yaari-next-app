(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{5521:function(e,t,r){Promise.resolve().then(r.bind(r,3429))},3429:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return LoginPage}});var n=r(7437),o=r(4033),l=r(2265);function useLoadGsiScript(e={}){let{nonce:t,onScriptLoadSuccess:r,onScriptLoadError:n}=e,[o,i]=(0,l.useState)(!1),a=(0,l.useRef)(r);a.current=r;let c=(0,l.useRef)(n);return c.current=n,(0,l.useEffect)(()=>{let e=document.createElement("script");return e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.nonce=t,e.onload=()=>{var e;i(!0),null===(e=a.current)||void 0===e||e.call(a)},e.onerror=()=>{var e;i(!1),null===(e=c.current)||void 0===e||e.call(c)},document.body.appendChild(e),()=>{document.body.removeChild(e)}},[t]),o}let i=(0,l.createContext)(null);function GoogleOAuthProvider({clientId:e,nonce:t,onScriptLoadSuccess:r,onScriptLoadError:n,children:o}){let a=useLoadGsiScript({nonce:t,onScriptLoadSuccess:r,onScriptLoadError:n}),c=(0,l.useMemo)(()=>({clientId:e,scriptLoadedSuccessfully:a}),[e,a]);return l.createElement(i.Provider,{value:c},o)}function useGoogleOAuth(){let e=(0,l.useContext)(i);if(!e)throw Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function useGoogleLogin({flow:e="implicit",scope:t="",onSuccess:r,onError:n,onNonOAuthError:o,overrideScope:i,state:a,...c}){let{clientId:s,scriptLoadedSuccessfully:u}=useGoogleOAuth(),d=(0,l.useRef)(),p=(0,l.useRef)(r);p.current=r;let g=(0,l.useRef)(n);g.current=n;let f=(0,l.useRef)(o);f.current=o,(0,l.useEffect)(()=>{var r,n;if(!u)return;let o="implicit"===e?"initTokenClient":"initCodeClient",l=null===(n=null===(r=null==window?void 0:window.google)||void 0===r?void 0:r.accounts)||void 0===n?void 0:n.oauth2[o]({client_id:s,scope:i?t:`openid profile email ${t}`,callback:e=>{var t,r;if(e.error)return null===(t=g.current)||void 0===t?void 0:t.call(g,e);null===(r=p.current)||void 0===r||r.call(p,e)},error_callback:e=>{var t;null===(t=f.current)||void 0===t||t.call(f,e)},state:a,...c});d.current=l},[s,u,e,t,a]);let h=(0,l.useCallback)(e=>{var t;return null===(t=d.current)||void 0===t?void 0:t.requestAccessToken(e)},[]),m=(0,l.useCallback)(()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.requestCode()},[]);return"implicit"===e?h:m}var a=r(3103);let c=(0,a.fo)("GoogleAuth",{web:()=>r.e(619).then(r.bind(r,8619)).then(e=>new e.GoogleAuthWeb)});var s=r(5128);function LoginScreen(e){let{onNext:t}=e,r=(0,o.useRouter)(),[i,u]=(0,l.useState)(""),[d,p]=(0,l.useState)(!1),[g,f]=(0,l.useState)(!1),[h,m]=(0,l.useState)(!1),[v,y]=(0,l.useState)(!1);(0,l.useEffect)(()=>{y(a.dV.isNativePlatform()),a.dV.isNativePlatform()&&c.initialize({clientId:"38963010109-kms7n3hb3dno6m5ol27km954mnmbf0vc.apps.googleusercontent.com",scopes:["profile","email"],grantOfflineAccess:!1})},[]);let handleGoogleLoginSuccess=async(e,t,n,o)=>{try{let l=await fetch("https://acsgroup.cloud/api/auth/google-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,name:t,googleId:n,profilePic:o})});if(l.ok){let i=await l.json();localStorage.setItem("user",JSON.stringify(i.user));let a=i.user.name&&i.user.gender?"/users":"/language";r.push(a),(0,s.QU)(n,{Name:t,Email:e,"Login Method":"Google","Profile Picture":o}).catch(e=>console.log("Tracking error:",e)),(0,s.L9)("User Login",{"Login Method":"Google","User ID":n,Email:e}).catch(e=>console.log("Tracking error:",e))}else alert("Failed to login with Google")}catch(e){console.error("Google login error:",e),alert("Error logging in with Google")}finally{m(!1)}},b=useGoogleLogin({onSuccess:async e=>{try{let t=await fetch("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:"Bearer ".concat(e.access_token)}}),r=await t.json();handleGoogleLoginSuccess(r.email,r.name,r.sub,r.picture).catch(e=>{console.error("Login success handler error:",e),m(!1)})}catch(e){console.error("Error fetching user info:",e),alert("Failed to get user information"),m(!1)}},onError:()=>{m(!1),alert("Google Sign-In was cancelled or failed")}}),handleSendOTP=async()=>{if(10!==i.length){alert("Please enter valid 10 digit phone number");return}f(!0);try{let e=a.dV.isNativePlatform()?"".concat("https://acsgroup.cloud","/api/auth/send-otp"):"/api/auth/send-otp",r=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:i})});if(r.ok)localStorage.setItem("phone",i),await (0,s.L9)("OTP Requested",{"Login Method":"Phone","Phone Number":i}),t();else{let e=await r.json().catch(()=>({}));alert(e.error||"Failed to send OTP")}}catch(e){alert("Error sending OTP")}finally{f(!1)}},handleGoogleSignIn=async()=>{if(m(!0),v)try{let e=await c.signIn();await handleGoogleLoginSuccess(e.email,e.name,e.id,e.imageUrl)}catch(o){var e,t,r;console.error("Native Google Sign-In error:",o),"string"==typeof o||null==o||o.message;let n=null!==(r=null!==(t=null!==(e=null==o?void 0:o.code)&&void 0!==e?e:null==o?void 0:o.statusCode)&&void 0!==t?t:null==o?void 0:o.status)&&void 0!==r?r:"";alert("Error signing in with Google".concat(n?" (code: ".concat(n,")"):""));try{b()}catch(e){}}finally{m(!1)}else b()},x=i?"+91 ".concat(i):"+91 ";return(0,n.jsxs)("div",{className:"min-h-screen flex flex-col relative",children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url(/images/loginScreenBackgroundImage.png)"}}),(0,n.jsxs)("div",{className:"absolute left-0 right-0 bg-white rounded-t-3xl p-8 shadow-lg transition-all duration-300 z-10 ".concat("bottom-0"),style:{paddingBottom:d?"env(safe-area-inset-bottom, 20px)":"32px"},children:[(0,n.jsxs)("div",{className:"text-center mb-6",children:[(0,n.jsx)("h1",{className:"text-4xl font-bold text-primary mb-2",children:"Yaari"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Connect with real people"})]}),(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsx)("input",{type:"tel",inputMode:"numeric",placeholder:"Enter your Phone Number",value:x,onChange:e=>{let t=e.target.value.replace(/[^0-9]/g,"");t.startsWith("91")&&(t=t.slice(2)),t.length<=10&&u(t)},onFocus:()=>p(!0),onBlur:()=>p(!1),className:"w-full p-4 border border-gray-300 rounded-full text-base focus:outline-none focus:border-primary bg-gray-50",style:{fontSize:"16px"}})}),(0,n.jsx)("button",{onClick:handleSendOTP,disabled:g,className:"w-full bg-primary text-white py-4 rounded-full font-semibold text-base mb-4 disabled:opacity-50 flex items-center justify-center",children:g?"Sending...":"Get OTP"}),(0,n.jsxs)("div",{className:"flex items-center mb-4",children:[(0,n.jsx)("div",{className:"flex-1 border-t border-gray-300"}),(0,n.jsx)("span",{className:"px-4 text-gray-500 text-sm",children:"OR"}),(0,n.jsx)("div",{className:"flex-1 border-t border-gray-300"})]}),(0,n.jsxs)("button",{onClick:handleGoogleSignIn,disabled:h,className:"w-full bg-white border-2 border-gray-300 text-gray-700 py-4 rounded-full font-semibold text-base mb-3 disabled:opacity-50 flex items-center justify-center gap-3",children:[(0,n.jsxs)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[(0,n.jsx)("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,n.jsx)("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,n.jsx)("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,n.jsx)("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),h?"Signing in...":"Continue with Google"]}),(0,n.jsx)("a",{href:"https://yaari.me/terms",target:"_blank",rel:"noopener noreferrer",className:"block text-center text-xs text-primary",children:"Terms & Conditions"})]})]})}function LoginPage(){let e=(0,o.useRouter)(),[t,r]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{r(!0);let t=localStorage.getItem("user");if(t)try{let r=JSON.parse(t);r.name&&r.gender?e.replace("/users"):e.replace("/language")}catch(e){}},[e]),t)?(0,n.jsx)(GoogleOAuthProvider,{clientId:"38963010109-kms7n3hb3dno6m5ol27km954mnmbf0vc.apps.googleusercontent.com",children:(0,n.jsx)(LoginScreen,{onNext:()=>e.push("/otp")})}):null}},5128:function(e,t,r){"use strict";r.d(t,{H4:function(){return trackAppOpen},L9:function(){return trackEvent},Lj:function(){return updateUserProfile},QU:function(){return trackUserLogin},Tf:function(){return trackSubscription},YY:function(){return trackProfileView},o$:function(){return trackScreenView}});var n=r(1007),o=r(3103),l=r(4725);(()=>{if(o.dV.isNativePlatform())return;let e=window;if(e.clevertap)return;e.clevertap={event:[],profile:[],account:[],onUserLogin:[],region:"eu1"},e.clevertap.account.push({id:"775-RZ7-W67Z"});let t=document.createElement("script");t.src="https://static.clevertap.com/js/clevertap.min.js",t.type="text/javascript",t.async=!0,t.onload=()=>console.log("CleverTap Web SDK loaded"),t.onerror=e=>console.error("CleverTap Web SDK load failed:",e);let r=document.getElementsByTagName("script")[0];((null==r?void 0:r.parentNode)||document.head).insertBefore(t,r||null)})(),(0,l.BP)();let isCleverTapAvailable=()=>o.dV.isNativePlatform(),formatPhoneE164=e=>{if(!e)return;let t=String(e).trim();if(t.startsWith("+"))return t;let r=t.replace(/[^0-9]/g,"");return 10===r.length?"+91".concat(r):12===r.length&&r.startsWith("91")?"+".concat(r):void 0},updateUserProfile=async e=>{let t={...e},r=formatPhoneE164(e.Phone);r?t.Phone=r:delete t.Phone;try{(0,l.Bq)(t)}catch(e){}if(isCleverTapAvailable())try{await n.z.profileSet(t)}catch(e){console.log("CleverTap profileSet error:",e)}else try{var o,i;null===(i=window.clevertap)||void 0===i||null===(o=i.profile)||void 0===o||o.push({Site:t})}catch(e){console.log("Web CleverTap profile push error:",e)}},trackUserLogin=async(e,t)=>{let r={Identity:e,...t||{}},o=formatPhoneE164(r.Phone);o?r.Phone=o:delete r.Phone,updateUserProfile(t||{}).catch(e=>console.log("Profile update error:",e));try{(0,l.xU)(e),r&&(0,l.Bq)(r)}catch(e){}if(isCleverTapAvailable())try{let e=n.z.onUserLogin(r),t=new Promise((e,t)=>{setTimeout(()=>t(Error("CleverTap login timeout")),3e3)});await Promise.race([e,t]),console.log("User login tracked successfully")}catch(e){console.log("CleverTap onUserLogin error:",e)}else try{var i,a;null===(a=window.clevertap)||void 0===a||null===(i=a.onUserLogin)||void 0===i||i.push({Site:r}),console.log("User login tracked successfully")}catch(e){console.log("Web CleverTap onUserLogin error:",e)}},trackEvent=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=new Promise((r,o)=>{try{if(isCleverTapAvailable())t&&Object.keys(t).length>0?n.z.recordEventWithNameAndProps(e,t):n.z.recordEventWithName(e);else{var l,i,a,c;t&&Object.keys(t).length>0?null===(i=window.clevertap)||void 0===i||null===(l=i.event)||void 0===l||l.push(e,t):null===(c=window.clevertap)||void 0===c||null===(a=c.event)||void 0===a||a.push(e)}r()}catch(e){o(e)}}),o=new Promise((e,t)=>{setTimeout(()=>t(Error("CleverTap event timeout")),2e3)});await Promise.race([r,o]),(0,l.WO)(e,t),console.log("Event tracked: ".concat(e),t)}catch(e){console.error("Error tracking event:",e)}},trackProfileView=async e=>{await trackEvent("Profile Viewed",{"Viewed User ID":e})},trackSubscription=async(e,t,r)=>{await trackEvent("Subscription Purchased",{"Plan Name":e,Amount:t,Currency:r})},trackAppOpen=async()=>{try{(0,l.WO)("App Open")}catch(e){}if(isCleverTapAvailable())try{await n.z.notifyDeviceReady(),await n.z.recordEventWithName("App Open")}catch(e){console.log("CleverTap notifyDeviceReady/App Open error:",e)}else try{var e,t;null===(t=window.clevertap)||void 0===t||null===(e=t.event)||void 0===e||e.push("App Open")}catch(e){console.log("Web CleverTap App Open error:",e)}},trackScreenView=async e=>{await trackEvent("Screen View",{"Screen Name":e})}},4725:function(e,t,r){"use strict";r.d(t,{BP:function(){return initMixpanel},Bq:function(){return mixpanelPeopleSet},WO:function(){return mixpanelTrack},xU:function(){return mixpanelIdentify}});var n=r(718);let o=!1,getToken=()=>{let e="b19e0189e8c34fe2a980f09ba1ceeedc";return e&&e.trim().length>0?e.trim():"b19e0189e8c34fe2a980f09ba1ceeedc"},initMixpanel=e=>{if(o)return;let t=e||getToken();if(!t){console.warn("Mixpanel token missing. Set NEXT_PUBLIC_MIXPANEL_TOKEN in .env.local");return}n.Z.init(t,{debug:!0,track_pageview:!1}),o=!0,console.log("Mixpanel initialized")},mixpanelTrack=(e,t)=>{try{if(initMixpanel(),!o)return;t&&Object.keys(t).length>0?n.Z.track(e,t):n.Z.track(e)}catch(e){console.log("Mixpanel track error:",e)}},mixpanelIdentify=e=>{try{if(initMixpanel(),!o)return;n.Z.identify(e)}catch(e){console.log("Mixpanel identify error:",e)}},normalizePeopleProps=e=>{var t,r,n;let o={...e},l=null!==(t=e.Name)&&void 0!==t?t:e.name,i=null!==(r=e.Email)&&void 0!==r?r:e.email,a=null!==(n=e.Phone)&&void 0!==n?n:e.phone;return l&&(o.$name=String(l),delete o.Name,delete o.name),i&&(o.$email=String(i),delete o.Email,delete o.email),a&&(o.$phone=String(a),delete o.Phone,delete o.phone),o},mixpanelPeopleSet=e=>{try{if(initMixpanel(),!o)return;let t=normalizePeopleProps(e);n.Z.people.set(t)}catch(e){console.log("Mixpanel people.set error:",e)}}},622:function(e,t,r){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(2265),o=Symbol.for("react.element"),l=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,r){var n,c={},s=null,u=null;for(n in void 0!==r&&(s=""+r),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(u=t.ref),t)l.call(t,n)&&!a.hasOwnProperty(n)&&(c[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===c[n]&&(c[n]=t[n]);return{$$typeof:o,type:e,key:s,ref:u,props:c,_owner:i.current}}t.jsx=q,t.jsxs=q},7437:function(e,t,r){"use strict";e.exports=r(622)},4033:function(e,t,r){e.exports=r(94)}},function(e){e.O(0,[601,623,971,472,744],function(){return e(e.s=5521)}),_N_E=e.O()}]);